<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AgroTrack — Iniciar sesión</title>
    <link rel="stylesheet" href="/estilos.css" />
  </head>
  <body>
    <header>
      <h1>AgroTrack</h1>
      <p>Portal interno — MVP</p>
    </header>

    <div class="container">
      <nav class="menu">
        <a class="btn" href="/">Inicio</a>
        <a class="btn" href="/productos.html">Productos</a>
        <a class="btn" href="/contacto.html">Contacto</a>
        <a class="btn active" href="/login.html">Login (demo)</a>
        <a class="btn outline" href="/consultas.html">Ver consultas</a>
        <a class="btn outline" href="/health" target="_blank"
          >estado del servidor</a
        >
      </nav>

      <section class="card">
        <h2>Iniciar sesión (demo)</h2>
        <p class="alert">Esto es una demostración sin seguridad.</p>

        <form id="login-form">
          <label for="usuario">Usuario</label>
          <input id="usuario" name="usuario" required />

          <label for="clave">Clave</label>
          <input id="clave" name="clave" type="password" required />

          <button type="submit" class="btn-submit">Enviar</button>
        </form>

        <p id="resultado-login" style="margin-top: 10px; font-weight: bold"></p>

        <script>
          document
            .getElementById("login-form")
            .addEventListener("submit", async (e) => {
              e.preventDefault();

              const usuario = document.getElementById("usuario").value;
              const clave = document.getElementById("clave").value;

              const res = await fetch("/auth/recuperar", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ usuario, clave }),
              });

              const data = await res.json();
              const resultado = document.getElementById("resultado-login");

              if (res.ok) {
                resultado.style.color = "green";
                resultado.textContent = `✅ ${data.mensaje} (usuario: ${data.usuario})`;
              } else {
                resultado.style.color = "red";
                resultado.textContent = `❌ ${data.error}`;
              }
            });
        </script>

        <p style="margin-top: 12px">
          <strong>Credenciales sugeridas:</strong> usuario <code>demo</code>,
          clave <code>1234</code> (o escribe las que quieras para ver el eco).
        </p>
      </section>
    </div>
  </body>
</html>
